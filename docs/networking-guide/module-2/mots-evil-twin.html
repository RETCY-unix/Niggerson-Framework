<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Section 2.5: MOTS and Evil Twin Attacks - Coverage of Man-on-the-Side, QUANTUM operations, Evil Twin access points, and advanced wireless attacks.">
    <title>2.5 MOTS AND EVIL TWIN | MODULE 2 | FIELD MANUAL</title>
    <link rel="stylesheet" href="../styles.css">
</head>

<body>
    <div class="classification-banner">
        UNCLASSIFIED // MODULE 2 // SECTION 2.5 // MOTS AND EVIL TWIN
    </div>

    <header class="site-header">
        <h1 class="site-title">Section 2.5</h1>
        <p class="site-subtitle">MOTS and Evil Twin Attacks</p>
    </header>

    <nav class="nav-main">
        <ul class="nav-list">
            <li><a href="../index.html" class="nav-link">HOME</a></li>
            <li><a href="index.html" class="nav-link">MODULE 2</a></li>
            <li><a href="mitm-attacks.html" class="nav-link">PREV: MITM ATTACKS</a></li>
            <li><a href="dns-attacks.html" class="nav-link">NEXT: DNS ATTACKS</a></li>
        </ul>
    </nav>

    <main class="container">
        <div class="content-wrapper">
            <nav class="breadcrumb">
                <a href="../index.html">Home</a>
                <span class="breadcrumb-separator">/</span>
                <a href="index.html">Module 2</a>
                <span class="breadcrumb-separator">/</span>
                <span>2.5 MOTS and Evil Twin</span>
            </nav>

            <p class="section-marker">// SECTION 2.5</p>
            <h1>Man-on-the-Side and Evil Twin Attacks</h1>

            <!-- ============================================
                 MOTS INTRODUCTION
                 ============================================ -->
            <h2>Man-on-the-Side Attacks</h2>

            <p>
                <strong>Man-on-the-Side (MOTS)</strong> attacks differ from MITM in that the attacker
                observes traffic passively but can inject responses that arrive before legitimate
                responses. Unlike MITM, the attacker does not intercept and relay traffic; instead,
                they race to respond first.
            </p>

            <p>
                MOTS attacks are associated with nation-state capabilities, as they typically require
                access to network infrastructure (ISP, backbone, or submarine cables) to observe
                traffic and inject packets with precise timing.
            </p>

            <div class="definition-block">
                <div class="definition-term">Man-on-the-Side (MOTS)</div>
                <div class="definition-desc">
                    An attack where the adversary can observe network traffic and inject packets but
                    cannot intercept or modify existing traffic. Success depends on racing the
                    legitimate response.
                </div>
            </div>

            <div class="diagram">
                MOTS vs MITM COMPARISON:

                MAN-IN-THE-MIDDLE:
                VICTIM ATTACKER SERVER
                | | |
                |---[Request]------------->| |
                | |---[Request]------------->|
                | |<--[Response]-------------| |<--[Modified Response]----| | | | | Attacker INTERCEPTS and RELAYS
                    traffic Full control over communications MAN-ON-THE-SIDE: VICTIM SERVER ATTACKER | | (Passive tap)
                    |---[Request]------------->|.....................|
                    | | [Observed] |
                    | | |
                    |<--[Injected Response]----|<--------------------| | ^ | (Race to respond) | | | | | |<--[Legit
                        Response]-------| | | (Arrives second, | | | often discarded) | | Attacker OBSERVES and INJECTS
                        Cannot block legitimate response Must win race condition </div>

                        <h3>QUANTUM INSERT</h3>

                        <p>
                            <strong>QUANTUM INSERT</strong> is a documented NSA/GCHQ technique that uses MOTS
                            positioning to inject malicious content by racing legitimate server responses.
                            When a target visits a monitored website, the system injects a redirect to an
                            exploitation server.
                        </p>

                        <div class="diagram">
                            QUANTUM INSERT OPERATION:

                            1. TARGET IDENTIFICATION:

                            TARGET PASSIVE COLLECTION QUANTUM
                            | | |
                            |---[Request: news.com]--->| [Selector Match!] |
                            | |---[Trigger]-------->|
                            | | |

                            2. RACE INJECTION:

                            | | |
                            | | |
                            |<============[INJECTED RESPONSE]=================| | Redirect to FOXACID exploitation
                                server | | | | |<--[Legit Response]-------| (Arrives late, | | (Discarded by client) |
                                TCP seq mismatch) | | | | 3. EXPLOITATION: TARGET FOXACID | | |---[Browser
                                redirected]------------------------->|
                                |<--[Exploitation payload]------------------------| | | | [Implant installed] | | |
                                    REQUIREMENTS: - Passive traffic observation capability - Low-latency injection path
                                    - Faster response than legitimate server - Exploitation infrastructure (FOXACID)
                                    </div>

                                    <div class="technical-block">
                                        <div class="technical-block-title">MOTS Attack Characteristics</div>
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>Aspect</th>
                                                    <th>Description</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Positioning</td>
                                                    <td>Network tap, ISP access, or backbone presence</td>
                                                </tr>
                                                <tr>
                                                    <td>Capability</td>
                                                    <td>Observe + inject (cannot intercept/modify)</td>
                                                </tr>
                                                <tr>
                                                    <td>Race Condition</td>
                                                    <td>Injected packet must arrive before legitimate</td>
                                                </tr>
                                                <tr>
                                                    <td>Detection</td>
                                                    <td>Duplicate responses, TCP RST anomalies</td>
                                                </tr>
                                                <tr>
                                                    <td>Attribution</td>
                                                    <td>Typically nation-state level capability</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <h3>MOTS Race Mechanics</h3>

                                    <div class="diagram">
                                        TCP RACE CONDITION:

                                        SCENARIO: Target requests http://example.com/page

                                        TARGET ATTACKER SERVER
                                        | | |
                                        |---[SYN]---------------------------------------->|
                                        |<--[SYN-ACK]<---------------------------------------|
                                            |---[ACK]-------------------------------------------->|
                                            | | |
                                            |---[GET /page HTTP/1.1]-->|---(observed)------------>|
                                            | | |
                                            | SEQ=1000, ACK=1 | |
                                            | | |
                                            RACE |<--[INJECTED RESPONSE]----| | | SEQ=1, ACK=1001 | | | (Correct
                                                sequence!) | | | | | |<--[LEGITIMATE RESPONSE]-------------------------|
                                                | SEQ=1, ACK=1001 | | | (Same sequence - | | | treated as duplicate, | |
                                                | often dropped) | | | | | CRITICAL FACTORS: - Attacker must
                                                predict/observe sequence numbers - Injection latency must be lower than
                                                server RTT - Packet must be valid TCP with correct checksums </div>

                                                <!-- ============================================
                 EVIL TWIN
                 ============================================ -->
                                                <h2>Evil Twin Attacks</h2>

                                                <p>
                                                    An <strong>Evil Twin</strong> is a rogue wireless access point that
                                                    impersonates a
                                                    legitimate network. Clients connecting to the evil twin have all
                                                    their traffic routed
                                                    through the attacker, establishing a wireless MITM position.
                                                </p>

                                                <div class="diagram">
                                                    EVIL TWIN ATTACK:

                                                    LEGITIMATE AP EVIL TWIN
                                                    SSID: "CoffeeShop_WiFi" SSID: "CoffeeShop_WiFi"
                                                    BSSID: AA:AA:AA:AA:AA:AA BSSID: XX:XX:XX:XX:XX:XX
                                                    Signal: -70 dBm Signal: -40 dBm (Stronger!)
                                                    Channel: 6 Channel: 6 (or 1/11)
                                                    | |
                                                    | |
                                                    | TARGET DEVICE |
                                                    | | |
                                                    | | Probe: "CoffeeShop_WiFi"? |
                                                    |<-------------------|--------------------------->|
                                                        | | |
                                                        | (Weaker signal) | (Stronger = preferred) |
                                                        | | |
                                                        | |---------[Associates]------>|
                                                        | | |
                                                        | | Connected to EVIL TWIN |
                                                        | | |
                                                        | | All traffic through |
                                                        | | attacker |
                                                        | | |

                                                        TRAFFIC FLOW:
                                                        TARGET EVIL TWIN INTERNET
                                                        | | |
                                                        |---[All traffic]--------->| [Inspect/Modify] |
                                                        | |---[Forward]------------->|
                                                        | |<--[Response]-------------| |<--[Modified Response]----| |
                                                            </div>

                                                            <h3>Evil Twin Setup</h3>

                                                            <div class="technical-block">
                                                                <div class="technical-block-title">Evil Twin Components
                                                                </div>
                                                                <ul>
                                                                    <li><strong>Wireless Interface:</strong> Monitor
                                                                        mode capable, packet injection</li>
                                                                    <li><strong>Access Point:</strong> hostapd or
                                                                        similar to create AP</li>
                                                                    <li><strong>DHCP Server:</strong> dnsmasq to assign
                                                                        IPs to victims</li>
                                                                    <li><strong>NAT/Routing:</strong> iptables to route
                                                                        traffic to Internet</li>
                                                                    <li><strong>Interception Tools:</strong> mitmproxy,
                                                                        Bettercap, or similar</li>
                                                                    <li><strong>Captive Portal:</strong> Optional -
                                                                        credential harvesting page</li>
                                                                </ul>
                                                            </div>

                                                            <div class="diagram">
                                                                EVIL TWIN NETWORK ARCHITECTURE:

                                                                +------------------+
                                                                | ATTACKER |
                                                                | LAPTOP |
                                                                | |
                                                                | +------------+ |
                                                                Wireless | | hostapd | |
                                                                Interface | | Evil Twin | | Wired Interface
                                                                (wlan0mon) <----|--| "FreeWiFi" | |-----> eth0
                                                                    | +------------+ | (to Internet)
                                                                    | | |
                                                                    | v |
                                                                    | +------------+ |
                                                                    | | dnsmasq | |
                                                                    | | DHCP + DNS | |
                                                                    | +------------+ |
                                                                    | | |
                                                                    | v |
                                                                    | +------------+ |
                                                                    | | iptables | |
                                                                    | | NAT + FWD | |
                                                                    | +------------+ |
                                                                    | | |
                                                                    | v |
                                                                    | +------------+ |
                                                                    | | mitmproxy | |
                                                                    | | Intercept | |
                                                                    | +------------+ |
                                                                    +------------------+

                                                                    VICTIM connects to Evil Twin:
                                                                    - Gets IP from dnsmasq (e.g., 10.0.0.100)
                                                                    - Gateway set to attacker (10.0.0.1)
                                                                    - DNS set to attacker
                                                                    - All traffic through mitmproxy
                                                            </div>

                                                            <h3>Captive Portal Attack</h3>

                                                            <div class="diagram">
                                                                CAPTIVE PORTAL CREDENTIAL HARVESTING:

                                                                1. VICTIM CONNECTS TO EVIL TWIN:
                                                                - No password required (open network)
                                                                - Or WPA2 with captured/common password

                                                                2. VICTIM OPENS BROWSER:

                                                                VICTIM EVIL TWIN
                                                                | |
                                                                |---[HTTP to any site]---->|
                                                                | |
                                                                |<--[302 Redirect to | | Captive Portal]-------| | | 3.
                                                                    CAPTIVE PORTAL DISPLAYED:
                                                                    +--------------------------------------------------+
                                                                    | COFFESHOP FREE WIFI | | | | Please enter your
                                                                    credentials to continue: | | | | Email:
                                                                    [_________________________] | | | | Password:
                                                                    [_____________________] | | | | [ ] I accept terms
                                                                    and conditions | | | | [ CONNECT ] | | | | Or sign
                                                                    in with: | | [Facebook] [Google] [Twitter] |
                                                                    +--------------------------------------------------+
                                                                    4. CREDENTIALS CAPTURED: - User enters personal
                                                                    email/password - Often reused credentials - OAuth
                                                                    phishing for social logins </div>

                                                                    <!-- ============================================
                 KARMA ATTACK
                 ============================================ -->
                                                                    <h2>Karma Attack</h2>

                                                                    <p>
                                                                        <strong>Karma attacks</strong> exploit the WiFi
                                                                        probe request mechanism. Devices
                                                                        constantly broadcast probe requests for
                                                                        previously connected networks. A Karma
                                                                        attack responds affirmatively to all probes,
                                                                        claiming to be any network the
                                                                        device is looking for.
                                                                    </p>

                                                                    <div class="diagram">
                                                                        KARMA ATTACK:

                                                                        NORMAL PROBE BEHAVIOR:

                                                                        DEVICE ACCESS POINT
                                                                        | |
                                                                        |---[Probe:
                                                                        "HomeWiFi"?]------------------------->|
                                                                        | "Is HomeWiFi here?" |
                                                                        | [No response - |
                                                                        | not that SSID] |
                                                                        | |

                                                                        KARMA ATTACK:

                                                                        DEVICE KARMA AP
                                                                        | |
                                                                        |---[Probe:
                                                                        "HomeWiFi"?]------------------------->|
                                                                        | |
                                                                        |<--[Probe Response: "Yes, I am HomeWiFi!"
                                                                            ]-------| | | |---[Authentication
                                                                            Request]--------------------->|
                                                                            |<--[Authentication
                                                                                Success]----------------------| | |
                                                                                |---[Association
                                                                                Request]------------------------>|
                                                                                |<--[Association
                                                                                    Response]------------------------| |
                                                                                    | | [CONNECTED TO ATTACKER] | | |
                                                                                    PROBE LIST HARVESTING: Device probes
                                                                                    reveal network history: - "HomeWiFi"
                                                                                    (Home network) - "CORPNET" (Work
                                                                                    network) - "Starbucks" (Coffee shop)
                                                                                    - "HiltonHonors" (Hotel)
                                                                                    - "United_WiFi" (Airplane) Each
                                                                                    reveals user habits and potential
                                                                                    targets </div>

                                                                                    <div class="technical-block">
                                                                                        <div
                                                                                            class="technical-block-title">
                                                                                            Karma Attack Variants</div>
                                                                                        <table>
                                                                                            <thead>
                                                                                                <tr>
                                                                                                    <th>Variant</th>
                                                                                                    <th>Behavior</th>
                                                                                                </tr>
                                                                                            </thead>
                                                                                            <tbody>
                                                                                                <tr>
                                                                                                    <td>Classic Karma
                                                                                                    </td>
                                                                                                    <td>Respond to all
                                                                                                        probes with
                                                                                                        matching SSID
                                                                                                    </td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td>Loud Karma</td>
                                                                                                    <td>Broadcast fake
                                                                                                        beacons for
                                                                                                        probed SSIDs
                                                                                                    </td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td>MANA</td>
                                                                                                    <td>Enhanced Karma
                                                                                                        with additional
                                                                                                        features</td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td>Known Beacons
                                                                                                    </td>
                                                                                                    <td>Broadcast common
                                                                                                        SSID beacons
                                                                                                        proactively</td>
                                                                                                </tr>
                                                                                            </tbody>
                                                                                        </table>
                                                                                    </div>

                                                                                    <!-- ============================================
                 DEAUTHENTICATION
                 ============================================ -->
                                                                                    <h2>Deauthentication Attacks</h2>

                                                                                    <p>
                                                                                        <strong>Deauthentication
                                                                                            attacks</strong> force
                                                                                        clients to disconnect from
                                                                                        legitimate
                                                                                        access points, creating
                                                                                        opportunities for evil twin
                                                                                        association or simply causing
                                                                                        denial of service.
                                                                                    </p>

                                                                                    <div class="diagram">
                                                                                        DEAUTHENTICATION ATTACK:

                                                                                        LEGITIMATE AP TARGET ATTACKER
                                                                                        | | |
                                                                                        |<=======[Connected]=======| | |
                                                                                            | | | | | |<--[Deauth
                                                                                            Frame]---------|<--[Spoofed
                                                                                            Deauth]-------|
                                                                                            | "AP kicking you out" |
                                                                                            Src: Legit AP BSSID | | |
                                                                                            Dst: Target MAC | | |
                                                                                            Reason: Unspecified | | | |
                                                                                            | [Disconnected] | [Client
                                                                                            disconnects] | | | | DEAUTH
                                                                                            FRAME (IEEE 802.11):
                                                                                            +-------------------------------------------+
                                                                                            | Frame Control:
                                                                                            Deauthentication | |
                                                                                            Duration: 0 | | Destination:
                                                                                            Client MAC (or broadcast) |
                                                                                            | Source: Legitimate AP
                                                                                            BSSID (spoofed) | | BSSID:
                                                                                            Legitimate AP BSSID | |
                                                                                            Reason Code: 7 (Class 3
                                                                                            frame from | |
                                                                                            non-associated station) |
                                                                                            +-------------------------------------------+
                                                                                            USE CASES: 1. Force
                                                                                            reconnection to evil twin 2.
                                                                                            Capture WPA handshake for
                                                                                            cracking 3. Denial of
                                                                                            service 4. Disrupt security
                                                                                            camera feeds </div>

                                                                                            <!-- ============================================
                 DETECTION AND DEFENSE
                 ============================================ -->
                                                                                            <h2>Detection and Defense
                                                                                            </h2>

                                                                                            <table>
                                                                                                <thead>
                                                                                                    <tr>
                                                                                                        <th>Attack</th>
                                                                                                        <th>Detection
                                                                                                        </th>
                                                                                                        <th>Defense</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody>
                                                                                                    <tr>
                                                                                                        <td>MOTS/QUANTUM
                                                                                                        </td>
                                                                                                        <td>Duplicate
                                                                                                            TCP
                                                                                                            responses,
                                                                                                            latency
                                                                                                            analysis
                                                                                                        </td>
                                                                                                        <td>TLS
                                                                                                            everywhere,
                                                                                                            certificate
                                                                                                            pinning</td>
                                                                                                    </tr>
                                                                                                    <tr>
                                                                                                        <td>Evil Twin
                                                                                                        </td>
                                                                                                        <td>BSSID
                                                                                                            monitoring,
                                                                                                            signal
                                                                                                            analysis
                                                                                                        </td>
                                                                                                        <td>802.1X,
                                                                                                            certificate-based
                                                                                                            auth, VPN
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    <tr>
                                                                                                        <td>Karma</td>
                                                                                                        <td>Probe
                                                                                                            response
                                                                                                            monitoring
                                                                                                        </td>
                                                                                                        <td>Disable
                                                                                                            auto-connect,
                                                                                                            clear saved
                                                                                                            networks
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    <tr>
                                                                                                        <td>Deauth</td>
                                                                                                        <td>Deauth frame
                                                                                                            monitoring,
                                                                                                            WIDS</td>
                                                                                                        <td>802.11w
                                                                                                            (Management
                                                                                                            Frame
                                                                                                            Protection)
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                </tbody>
                                                                                            </table>

                                                                                            <div
                                                                                                class="technical-block">
                                                                                                <div
                                                                                                    class="technical-block-title">
                                                                                                    Wireless Security
                                                                                                    Best Practices</div>
                                                                                                <ul>
                                                                                                    <li><strong>Use
                                                                                                            WPA3:</strong>
                                                                                                        SAE provides
                                                                                                        forward secrecy
                                                                                                        and deauth
                                                                                                        protection</li>
                                                                                                    <li><strong>Enable
                                                                                                            802.11w:</strong>
                                                                                                        Protected
                                                                                                        Management
                                                                                                        Frames</li>
                                                                                                    <li><strong>802.1X/EAP:</strong>
                                                                                                        Certificate-based
                                                                                                        authentication
                                                                                                    </li>
                                                                                                    <li><strong>VPN:</strong>
                                                                                                        Encrypt all
                                                                                                        traffic
                                                                                                        regardless of
                                                                                                        network</li>
                                                                                                    <li><strong>Disable
                                                                                                            Auto-Connect:</strong>
                                                                                                        Require manual
                                                                                                        network
                                                                                                        selection</li>
                                                                                                    <li><strong>WIDS/WIPS:</strong>
                                                                                                        Wireless
                                                                                                        intrusion
                                                                                                        detection/prevention
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>

                                                                                            <!-- ============================================
                 SECTION SUMMARY
                 ============================================ -->
                                                                                            <h2>Section Summary</h2>

                                                                                            <p>
                                                                                                This section covered
                                                                                                advanced wireless and
                                                                                                network positioning
                                                                                                attacks:
                                                                                            </p>

                                                                                            <ul>
                                                                                                <li>MOTS attacks:
                                                                                                    passive observation
                                                                                                    with active
                                                                                                    injection</li>
                                                                                                <li>QUANTUM INSERT:
                                                                                                    nation-state race
                                                                                                    injection technique
                                                                                                </li>
                                                                                                <li>Evil Twin: rogue
                                                                                                    access point
                                                                                                    impersonation</li>
                                                                                                <li>Captive portals:
                                                                                                    credential
                                                                                                    harvesting</li>
                                                                                                <li>Karma attacks: probe
                                                                                                    request exploitation
                                                                                                </li>
                                                                                                <li>Deauthentication:
                                                                                                    forced disconnection
                                                                                                    attacks</li>
                                                                                            </ul>

                                                                                            <div
                                                                                                class="technical-block">
                                                                                                <div
                                                                                                    class="technical-block-title">
                                                                                                    Key Takeaways</div>
                                                                                                <ul>
                                                                                                    <li>MOTS requires
                                                                                                        infrastructure
                                                                                                        access but is
                                                                                                        very stealthy
                                                                                                    </li>
                                                                                                    <li>Evil Twin is
                                                                                                        accessible
                                                                                                        attack with
                                                                                                        powerful results
                                                                                                    </li>
                                                                                                    <li>WiFi probe
                                                                                                        requests reveal
                                                                                                        network history
                                                                                                    </li>
                                                                                                    <li>Deauth attacks
                                                                                                        enable both DoS
                                                                                                        and MITM
                                                                                                        positioning</li>
                                                                                                    <li>VPN and
                                                                                                        certificate
                                                                                                        validation are
                                                                                                        primary defenses
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>

                                                                                            <h2>Navigation</h2>
                                                                                            <p>
                                                                                                <a href="mitm-attacks.html"
                                                                                                    class="nav-link"
                                                                                                    style="display: inline-block;">RETURN
                                                                                                    TO SECTION 2.4</a>
                                                                                                <span
                                                                                                    style="margin: 0 1rem; color: var(--text-muted);">|</span>
                                                                                                <a href="dns-attacks.html"
                                                                                                    class="nav-link"
                                                                                                    style="display: inline-block;">PROCEED
                                                                                                    TO SECTION 2.6: DNS
                                                                                                    ATTACKS</a>
                                                                                            </p>
                                                                                    </div>
    </main>

    <footer class="site-footer">
        <p class="footer-text">
            Section 2.5: MOTS and Evil Twin Attacks // Module 2 // Field Manual<br>
            Classification: Unclassified
        </p>
    </footer>
</body>

</html>