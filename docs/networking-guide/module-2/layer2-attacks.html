<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Section 2.3: Layer 2 Attacks - Comprehensive coverage of VLAN hopping, STP manipulation, DHCP attacks, and switch exploitation techniques.">
    <title>2.3 LAYER 2 ATTACKS | MODULE 2 | FIELD MANUAL</title>
    <link rel="stylesheet" href="../styles.css">
</head>

<body>
    <div class="classification-banner">
        UNCLASSIFIED // MODULE 2 // SECTION 2.3 // LAYER 2 ATTACKS
    </div>

    <header class="site-header">
        <h1 class="site-title">Section 2.3</h1>
        <p class="site-subtitle">Layer 2 Attacks</p>
    </header>

    <nav class="nav-main">
        <ul class="nav-list">
            <li><a href="../index.html" class="nav-link">HOME</a></li>
            <li><a href="index.html" class="nav-link">MODULE 2</a></li>
            <li><a href="arp-attacks.html" class="nav-link">PREV: ARP ATTACKS</a></li>
            <li><a href="mitm-attacks.html" class="nav-link">NEXT: MITM ATTACKS</a></li>
        </ul>
    </nav>

    <main class="container">
        <div class="content-wrapper">
            <nav class="breadcrumb">
                <a href="../index.html">Home</a>
                <span class="breadcrumb-separator">/</span>
                <a href="index.html">Module 2</a>
                <span class="breadcrumb-separator">/</span>
                <span>2.3 Layer 2 Attacks</span>
            </nav>

            <p class="section-marker">// SECTION 2.3</p>
            <h1>Layer 2 Attacks</h1>

            <!-- ============================================
                 INTRODUCTION
                 ============================================ -->
            <h2>Overview</h2>

            <p>
                Layer 2 attacks target the Data Link Layer infrastructure, exploiting vulnerabilities
                in switching, VLAN segmentation, and network protocols such as STP and DHCP. These attacks
                can bypass Layer 3 security controls by operating at the foundational network layer,
                making them particularly dangerous in enterprise environments.
            </p>

            <p>
                Understanding Layer 2 attack vectors is critical for both penetration testing and
                network defense. Many organizations focus security efforts on Layer 3 and above,
                leaving Layer 2 infrastructure vulnerable to exploitation.
            </p>

            <!-- ============================================
                 VLAN HOPPING
                 ============================================ -->
            <h2>VLAN Hopping</h2>

            <p>
                <strong>VLAN hopping</strong> enables an attacker to access traffic on VLANs that should
                be isolated from their network segment. Two primary techniques exist: switch spoofing
                and double tagging.
            </p>

            <h3>Switch Spoofing</h3>

            <p>
                <strong>Switch spoofing</strong> exploits the Dynamic Trunking Protocol (DTP) to negotiate
                a trunk link with the switch. Once established, the attacker can send and receive traffic
                on any VLAN carried by the trunk.
            </p>

            <div class="diagram">
                SWITCH SPOOFING ATTACK:

                NORMAL ACCESS PORT:
                +----------+ +----------+
                | Attacker |--[Access VLAN 10]-->| SWITCH |
                +----------+ +----------+
                Only sees VLAN 10 traffic

                SWITCH SPOOFING:
                +----------+ +----------+
                | Attacker |--[Trunk 802.1Q]---->| SWITCH |
                | (DTP) | Negotiates trunk | (DTP On) |
                +----------+ +----------+

                Attack Steps:
                1. Attacker sends DTP frames (desirable mode)
                2. Switch (if DTP enabled) negotiates trunk
                3. Trunk established with 802.1Q tagging
                4. Attacker accesses all VLANs on trunk

                DTP FRAME:
                +---------------------------------------------+
                | Domain: (matches switch or null) |
                | Status: Access/Desirable/On |
                | Type: 802.1Q |
                +---------------------------------------------+

                RESULT:
                +----------+ +----------+
                | Attacker |=====[TRUNK]========>| SWITCH |
                +----------+ VLAN 10,20,30,40 +----------+

                Can send/receive on ANY VLAN
            </div>

            <h3>Double Tagging</h3>

            <p>
                <strong>Double tagging</strong> (also called 802.1Q nesting) exploits how switches handle
                nested VLAN tags. The outer tag is stripped by the first switch, revealing the inner
                tag which routes the frame to a different VLAN.
            </p>

            <div class="diagram">
                DOUBLE TAGGING ATTACK:

                REQUIREMENTS:
                - Attacker on native VLAN (often VLAN 1)
                - Native VLAN same on both switches
                - Target VLAN exists on destination switch

                ATTACK FLOW:

                1. Attacker creates double-tagged frame:
                +--------------------------------------------------+
                | Eth Hdr | VLAN 1 | VLAN 20 | IP | Data | FCS |
                | | (Outer)| (Inner) | | | |
                +--------------------------------------------------+
                ^ ^
                Native VLAN Target VLAN
                (stripped) (delivered)

                2. Frame reaches first switch (on native VLAN):
                - Outer tag (VLAN 1) stripped (native VLAN)
                - Frame forwarded as native VLAN traffic

                3. Frame arrives at second switch:
                +------------------------------------------+
                | Eth Hdr | VLAN 20 | IP | Data | FCS |
                | | (Only) | | | |
                +------------------------------------------+
                - Switch sees VLAN 20 tag
                - Frame forwarded to VLAN 20

                4. Frame delivered to target on VLAN 20:
                +----------+ +----------+ +----------+
                | Attacker |---->| Switch 1 |---->| Switch 2 |----> [VLAN 20]
                | VLAN 1 | | | | | [Target]
                +----------+ +----------+ +----------+

                LIMITATION: One-way attack (no return path without ARP poison)
            </div>

            <div class="technical-block">
                <div class="technical-block-title">VLAN Hopping Prevention</div>
                <ul>
                    <li><strong>Disable DTP:</strong> Set all ports to access or trunk explicitly (switchport mode
                        access/trunk)</li>
                    <li><strong>Non-default Native VLAN:</strong> Use unused VLAN as native (not VLAN 1)</li>
                    <li><strong>Tag Native VLAN:</strong> Enable vlan dot1q tag native</li>
                    <li><strong>Prune Unused VLANs:</strong> Remove unnecessary VLANs from trunks</li>
                    <li><strong>Disable Unused Ports:</strong> Shutdown and assign to unused VLAN</li>
                </ul>
            </div>

            <!-- ============================================
                 STP ATTACKS
                 ============================================ -->
            <h2>Spanning Tree Protocol Attacks</h2>

            <p>
                The <strong>Spanning Tree Protocol (STP)</strong> prevents broadcast loops in switched
                networks by blocking redundant paths. Attackers can manipulate STP to disrupt network
                topology, cause denial of service, or redirect traffic through attacker-controlled paths.
            </p>

            <h3>Root Bridge Takeover</h3>

            <div class="diagram">
                STP ROOT BRIDGE ATTACK:

                NORMAL TOPOLOGY:
                [ROOT BRIDGE]
                Priority: 4096
                MAC: 00:00:00:00:00:01
                |
                +------------+------------+
                | |
                [Switch A] [Switch B]
                Priority: 32768 Priority: 32768
                | |
                [Host] [Attacker]

                ROOT BRIDGE ELECTION:
                - Lowest Bridge ID wins
                - Bridge ID = Priority + MAC Address
                - Default priority: 32768

                ATTACK:
                Attacker sends BPDU with lower Bridge ID:
                +-----------------------------------------------+
                | Root Bridge ID: 0.XX:XX:XX:XX:XX:XX |
                | Priority: 0 (lowest possible) |
                +-----------------------------------------------+

                NEW TOPOLOGY:
                [ATTACKER]
                Priority: 0
                NOW ROOT BRIDGE
                / \
                [Switch A] [Switch B]
                | |
                [Root] [Host]

                IMPACT:
                - All traffic flows through attacker
                - Network topology destabilized
                - Potential for interception or DoS
            </div>

            <h3>STP Denial of Service</h3>

            <div class="diagram">
                STP TOPOLOGY CHANGE DoS:

                ATTACK: Rapidly send Topology Change (TC) BPDUs

                Each TC causes:
                1. All switches clear MAC tables
                2. Traffic flooded until tables rebuild
                3. Network performance degradation

                CONTINUOUS TC STORM:
                +----------+ TC-BPDU +----------+ TC-BPDU +----------+
                | Attacker |--------------->| Switch A |--------------->| Switch B |
                +----------+ every 100ms +----------+ propagates +----------+
                | |
                (Clears MAC) (Clears MAC)
                | |
                FLOODING FLOODING

                RESULT: Network congestion, instability
            </div>

            <div class="technical-block">
                <div class="technical-block-title">STP Attack Prevention</div>
                <ul>
                    <li><strong>BPDU Guard:</strong> Shutdown ports that receive unexpected BPDUs</li>
                    <li><strong>Root Guard:</strong> Prevent ports from becoming root port</li>
                    <li><strong>BPDU Filter:</strong> Block BPDU transmission/reception on access ports</li>
                    <li><strong>Loop Guard:</strong> Prevent alternate ports from becoming designated</li>
                </ul>
            </div>

            <!-- ============================================
                 DHCP ATTACKS
                 ============================================ -->
            <h2>DHCP Attacks</h2>

            <h3>DHCP Starvation</h3>

            <p>
                <strong>DHCP starvation</strong> exhausts the DHCP server's address pool by requesting
                all available IP addresses. This prevents legitimate clients from obtaining IP configuration.
            </p>

            <div class="diagram">
                DHCP STARVATION ATTACK:

                DHCP POOL: 192.168.1.100 - 192.168.1.200 (100 addresses)

                ATTACKER sends DISCOVER with spoofed MACs:

                ROUND 1: MAC = AA:AA:AA:AA:AA:01 -> Gets 192.168.1.100
                ROUND 2: MAC = AA:AA:AA:AA:AA:02 -> Gets 192.168.1.101
                ROUND 3: MAC = AA:AA:AA:AA:AA:03 -> Gets 192.168.1.102
                ...
                ROUND 100: MAC = AA:AA:AA:AA:AA:64 -> Gets 192.168.1.199
                ROUND 101: MAC = AA:AA:AA:AA:AA:65 -> Gets 192.168.1.200

                POOL EXHAUSTED

                +----------+ DISCOVER +-------------+
                | Attacker |------------------>| DHCP Server |
                | (Rapid | [Spoofed MAC] | |
                | requests|<------------------| OFFER | | with new | [IP assigned] | (Depleting | | MAC
                    each|------------------>| pool) |
                    | request)| ACCEPT | |
                    +----------+ +-------------+

                    RESULT:
                    - Legitimate client sends DISCOVER
                    - Server has no addresses to offer
                    - Client cannot join network (DoS)
            </div>

            <h3>Rogue DHCP Server</h3>

            <p>
                A <strong>rogue DHCP server</strong> responds to client DHCP requests, providing
                malicious network configuration. This can redirect traffic through the attacker
                or establish MITM positioning.
            </p>

            <div class="diagram">
                ROGUE DHCP ATTACK:

                LEGITIMATE DHCP: 192.168.1.1:67
                ROGUE DHCP: 192.168.1.99:67 (Attacker)

                CLIENT ROGUE DHCP LEGIT DHCP
                | | |
                | DISCOVER (Broadcast) | |
                |---------------------->|<-----------------------| | | | | OFFER from ROGUE | OFFER from LEGIT |
                    |<----------------------| | | IP: 192.168.1.50 | | | GW: 192.168.1.99 | (Rogue responds | | DNS:
                    10.0.0.53 | faster, client | | (Attacker controlled)| accepts first) | | | | | REQUEST to ROGUE | |
                    |---------------------->| |
                    | | |
                    | ACK | |
                    |<----------------------| | | | | CLIENT NOW CONFIGURED WITH: - Gateway: 192.168.1.99 (Attacker -
                        MITM) - DNS: 10.0.0.53 (Attacker - DNS poison) All traffic routes through attacker </div>

                        <div class="technical-block">
                            <div class="technical-block-title">DHCP Attack Prevention</div>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Defense</th>
                                        <th>Protection</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>DHCP Snooping</td>
                                        <td>Only trusted ports can send DHCP offers</td>
                                    </tr>
                                    <tr>
                                        <td>Rate Limiting</td>
                                        <td>Limit DHCP requests per port</td>
                                    </tr>
                                    <tr>
                                        <td>Port Security</td>
                                        <td>Limit MACs per port (prevents MAC spoofing)</td>
                                    </tr>
                                    <tr>
                                        <td>IP Source Guard</td>
                                        <td>Validate IP/MAC from DHCP snooping table</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- ============================================
                 MAC SPOOFING
                 ============================================ -->
                        <h2>MAC Spoofing</h2>

                        <p>
                            <strong>MAC spoofing</strong> involves changing a network interface's MAC address to
                            impersonate another device. This can bypass MAC-based access controls, assume
                            another device's identity, or evade network monitoring.
                        </p>

                        <div class="diagram">
                            MAC SPOOFING SCENARIOS:

                            SCENARIO 1: Bypass MAC Filtering
                            +----------+ +----------+
                            | Attacker | | Switch |
                            | MAC: X | Access Denied | Whitelist|
                            | |------- X ------------->| AA:BB:CC |
                            +----------+ +----------+

                            Attacker changes MAC to AA:BB:CC:

                            +----------+ +----------+
                            | Attacker | | Switch |
                            | MAC: AA: | Access Granted | Whitelist|
                            | BB:CC |=======================>| AA:BB:CC |
                            +----------+ +----------+

                            SCENARIO 2: Session Hijacking
                            +----------+ +----------+
                            | Legit | Authenticated | Server |
                            | MAC: AA | Session established | |
                            +----------+ +----------+

                            Attacker clones MAC and waits for victim disconnect:

                            +----------+ +----------+
                            | Attacker | Takes over session | Server |
                            | MAC: AA | (Same MAC) | |
                            +----------+ +----------+

                            SCENARIO 3: Evade Detection
                            +----------+ Attack +----------+
                            | Attacker |------------->| Target |
                            | MAC: X | | |
                            +----------+ +----------+
                            \
                            \---> [IDS logs MAC: X]

                            Change MAC after each attack phase:

                            +----------+ Attack +----------+
                            | Attacker |------------->| Target |
                            | MAC: Y | | |
                            +----------+ +----------+
                            \
                            \---> [IDS logs MAC: Y - Different!]
                        </div>

                        <!-- ============================================
                 CDP/LLDP RECONNAISSANCE
                 ============================================ -->
                        <h2>CDP/LLDP Reconnaissance</h2>

                        <p>
                            <strong>Cisco Discovery Protocol (CDP)</strong> and <strong>Link Layer Discovery Protocol
                                (LLDP)</strong> are used for network device discovery. These protocols broadcast
                            sensitive
                            information that attackers can leverage for reconnaissance.
                        </p>

                        <div class="diagram">
                            CDP INFORMATION DISCLOSURE:

                            CDP FRAME CAPTURED:

                            +-----------------------------------------------+
                            | Device ID: SW-CORE-01.corp.local |
                            | Platform: cisco WS-C3850-24P |
                            | Capabilities: Router, Switch |
                            | IP Address: 10.1.1.1 |
                            | Software: IOS-XE 16.9.4 |
                            | Native VLAN: 1 |
                            | Duplex: Full |
                            | Power: 370W |
                            | VTP Domain: CORP |
                            +-----------------------------------------------+

                            RECONNAISSANCE VALUE:
                            - Device type and model (exploit selection)
                            - Software version (vulnerability lookup)
                            - Management IP (target identification)
                            - Native VLAN (double tagging attacks)
                            - VTP domain (VTP attacks)
                            - Network topology mapping
                        </div>

                        <div class="technical-block">
                            <div class="technical-block-title">CDP/LLDP Mitigation</div>
                            <ul>
                                <li><strong>Disable on Access Ports:</strong> no cdp enable / no lldp transmit</li>
                                <li><strong>Filter Information:</strong> Limit what data is advertised</li>
                                <li><strong>Enable Only on Infrastructure Links:</strong> Switch-to-switch,
                                    switch-to-router</li>
                            </ul>
                        </div>

                        <!-- ============================================
                 SECTION SUMMARY
                 ============================================ -->
                        <h2>Section Summary</h2>

                        <p>
                            This section covered Layer 2 attack techniques:
                        </p>

                        <ul>
                            <li>VLAN hopping: switch spoofing and double tagging</li>
                            <li>STP attacks: root bridge takeover and topology change DoS</li>
                            <li>DHCP attacks: starvation and rogue DHCP servers</li>
                            <li>MAC spoofing: identity impersonation and access control bypass</li>
                            <li>CDP/LLDP reconnaissance: information disclosure</li>
                        </ul>

                        <div class="technical-block">
                            <div class="technical-block-title">Key Takeaways</div>
                            <ul>
                                <li>Layer 2 attacks bypass Layer 3 security controls</li>
                                <li>Default switch configurations are often vulnerable</li>
                                <li>DHCP snooping is foundation for multiple Layer 2 defenses</li>
                                <li>Protocol security features must be explicitly enabled</li>
                                <li>Network reconnaissance often begins at Layer 2</li>
                            </ul>
                        </div>

                        <h2>Navigation</h2>
                        <p>
                            <a href="arp-attacks.html" class="nav-link" style="display: inline-block;">RETURN TO SECTION
                                2.2</a>
                            <span style="margin: 0 1rem; color: var(--text-muted);">|</span>
                            <a href="mitm-attacks.html" class="nav-link" style="display: inline-block;">PROCEED TO
                                SECTION 2.4: MITM ATTACKS</a>
                        </p>
            </div>
    </main>

    <footer class="site-footer">
        <p class="footer-text">
            Section 2.3: Layer 2 Attacks // Module 2 // Field Manual<br>
            Classification: Unclassified
        </p>
    </footer>
</body>

</html>